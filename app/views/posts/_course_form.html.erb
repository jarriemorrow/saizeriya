<div class="form-group" id="menu-fields-container">
  <% if @course_sections.present? %>
    <% @course_sections.each do |course_section| %>
      <% course_menu = @post.course_menus.find { |cm| cm.course_section_id == course_section.id } || @post.course_menus.build(course_section_id: course_section.id) %>
      <%= f.fields_for :course_menus, course_menu do |cm| %>
        <div class="menu-field max-w-full overflow-hidden break-words">
          <%= cm.hidden_field :course_section_id %>
          <%= cm.label :menu_id, course_section.name, class: "block truncate" %>
          <%= cm.collection_select :menu_id, Menu.all, :id, :menu_name, { include_blank: true }, { class: "form-control flex max-w-full break-words whitespace-normal" } %>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>